#!/bin/sh
# Script tstseq8a1 for bringing up Memory controller, and PIO sequence

echo "admin probe"
./swctl 0xDE000000 0xDFFF0000 settime
./swctl 0xDE000000 0xDFFF0000 admin

echo "reset workers"
./swctl 0xDE000000 0xDFFF0000 wwctl  4 0x00000004
./swctl 0xDE000000 0xDFFF0000 wwctl  3 0x00000004
./swctl 0xDE000000 0xDFFF0000 wwctl  2 0x00000004
./swctl 0xDE000000 0xDFFF0000 wwctl 12 0x0000000F

echo "unreset workers"
./swctl 0xDE000000 0xDFFF0000 wwctl  4 0x80000004
./swctl 0xDE000000 0xDFFF0000 wwctl  3 0x80000004
./swctl 0xDE000000 0xDFFF0000 wwctl  2 0x80000004
./swctl 0xDE000000 0xDFFF0000 wwctl 12 0x8000000F

echo "initialize workers"
./swctl 0xDE000000 0xDFFF0000 wop  4 initialize
./swctl 0xDE000000 0xDFFF0000 wop  3 initialize
./swctl 0xDE000000 0xDFFF0000 wop  2 initialize
./swctl 0xDE000000 0xDFFF0000 wop 12 initialize

echo "start workers"

./swctl 0xDE000000 0xDFFF0000 wop 12 start
./swctl 0xDE000000 0xDFFF0000 wop  4 start
./swctl 0xDE000000 0xDFFF0000 wop  3 start
./swctl 0xDE000000 0xDFFF0000 wop  2 start

#echo "Read Memory Controler Status"
./swctl 0xDE000000 0xDFFF0000 wread 12 0 36

# wait for controller ready...
echo "Waiting for the one second calibration"
sleep 2

echo "Read Memory Controler Status"
./swctl 0xDE000000 0xDFFF0000 wread 12 0 36

# mask
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x5C 0x0000FFFF  # mask (1=BE;0=Masked)

#echo "Setting up"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x03020100
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x07060504
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x0B0A0908
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x0F0E0D0C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000000   # Write

#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x13121110
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x17161514
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x1B1A1918
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x1F1E1D1C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000010   # Write

#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x23222120
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x27262524
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x2B2A2928
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x2F2E2D2C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000020   # Write

#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x33323130
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x37363534
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x3B3A3938
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x3F3E3D3C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000030   # Write

#echo "Read"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000000 # read addr
#./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000010 # read addr
#./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000020 # read addr
#./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000030 # read addr
#./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4

#./swctl 0xDE000000 0xDFFF0000 wread  12 0x48 1
#./swctl 0xDE000000 0xDFFF0000 wread  12 0x00 1

