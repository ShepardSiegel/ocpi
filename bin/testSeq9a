#!/bin/sh
# Script tstseq9 for bringing up Memory controller, and flat-map sequence

echo "admin probe"
./swctl 0xDE000000 0xDFFF0000 settime
./swctl 0xDE000000 0xDFFF0000 admin

echo "reset workers"
./swctl 0xDE000000 0xDFFF0000 wwctl  4 0x00000004
./swctl 0xDE000000 0xDFFF0000 wwctl  3 0x00000004
./swctl 0xDE000000 0xDFFF0000 wwctl  2 0x00000004
./swctl 0xDE000000 0xDFFF0000 wwctl 10 0x0000000F
./swctl 0xDE000000 0xDFFF0000 wwctl 11 0x0000000F
./swctl 0xDE000000 0xDFFF0000 wwctl 12 0x0000000F

echo "unreset workers"
./swctl 0xDE000000 0xDFFF0000 wwctl  4 0x80000004
./swctl 0xDE000000 0xDFFF0000 wwctl  3 0x80000004
./swctl 0xDE000000 0xDFFF0000 wwctl  2 0x80000004
./swctl 0xDE000000 0xDFFF0000 wwctl 10 0x8000000F
./swctl 0xDE000000 0xDFFF0000 wwctl 11 0x8000000F
./swctl 0xDE000000 0xDFFF0000 wwctl 12 0x8000000F

echo "initialize workers"
./swctl 0xDE000000 0xDFFF0000 wop  4 initialize
./swctl 0xDE000000 0xDFFF0000 wop  3 initialize
./swctl 0xDE000000 0xDFFF0000 wop  2 initialize
./swctl 0xDE000000 0xDFFF0000 wop 10 initialize
./swctl 0xDE000000 0xDFFF0000 wop 11 initialize
./swctl 0xDE000000 0xDFFF0000 wop 12 initialize

echo "start workers"

./swctl 0xDE000000 0xDFFF0000 wop 12 start
./swctl 0xDE000000 0xDFFF0000 wop 11 start
./swctl 0xDE000000 0xDFFF0000 wop 10 start
./swctl 0xDE000000 0xDFFF0000 wop  4 start
./swctl 0xDE000000 0xDFFF0000 wop  3 start
./swctl 0xDE000000 0xDFFF0000 wop  2 start

#echo "Read Memory Controler Status"
#./swctl 0xDE000000 0xDFFF0000 wread 12 0 19

# wait for controller ready...
sleep 1

echo "Read Memory Controler Status"
./swctl 0xDE000000 0xDFFF0000 wread 12 0 19

./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80000 0x03020100
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80004 0x07060504
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80008 0x0B0A0908
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x8000C 0x0F0E0D0C
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80010 0x13121110
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80014 0x17161514
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80018 0x1B1A1918
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x8001C 0x1F1E1D1C
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80020 0x23222120
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80024 0x27262524
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80028 0x2B2A2928
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x8002C 0x2F2E2D2C
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80030 0x33323130
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80034 0x37363534
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x80038 0x3B3A3938
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x8003C 0x3F3E3D3C

./swctl 0xDE000000 0xDFFF0000 wread  12 0x80000 16

# mask
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x5C 0x0000FFFF  # mask (1=BE;0=Masked)

#echo "Setting up"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x03020100
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x07060504
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x0B0A0908
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x0F0E0D0C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000000   # Write

#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x13121110
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x17161514
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x1B1A1918
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x1F1E1D1C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000010   # Write

#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x23222120
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x27262524
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x2B2A2928
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x2F2E2D2C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000020   # Write

#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x60 0x33323130
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x64 0x37363534
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x68 0x3B3A3938
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x6C 0x3F3E3D3C
#echo "Write"
#./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x54 0x00000030   # Write

echo "Read"
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000000 # read addr
./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000010 # read addr
./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000020 # read addr
./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4
./swctl 0xDE000000 0xDFFF0000 wwrite 12 0x58 0x00000030 # read addr
./swctl 0xDE000000 0xDFFF0000 wread  12 0x80 4

#./swctl 0xDE000000 0xDFFF0000 wread  12 0x48 1
#./swctl 0xDE000000 0xDFFF0000 wread  12 0x00 1

./swctl 0xDE000000 0xDFFF0000 dtest 12 0x80000 4
./swctl 0xDE000000 0xDFFF0000 wread 12 0x50 1
